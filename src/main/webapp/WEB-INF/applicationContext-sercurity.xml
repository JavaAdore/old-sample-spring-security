<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:security="http://www.springframework.org/schema/security"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
          http://www.springframework.org/schema/beans/spring-beans-4.2.xsd
          http://www.springframework.org/schema/security
          http://www.springframework.org/schema/security/spring-security-4.2.xsd">

	<security:http>
		<security:intercept-url pattern="/admin/*"
			access="hasRole('ADMIN')" />
			
		<security:intercept-url  pattern="/forAll*"  access="permitAll" requires-channel="https"/>
		
		<security:intercept-url  pattern="/authenticated*"  access="isAuthenticated()"/>
		
		<security:form-login login-page="/Login.jsp" />
		<security:csrf disabled="true" />
		<security:logout logout-url="/logout" logout-success-url="/index.jsp" invalidate-session="true"  />
	</security:http>


	<security:authentication-manager>
	
		 <security:ldap-authentication-provider    server-ref="ldapServer" user-search-base="ou=users" group-search-base="ou=groups" group-search-filter="(uniqueMember={0})" user-search-filter="(uid={0})" role-prefix=""  />
 
	</security:authentication-manager>
	
	<security:ldap-server  id="ldapServer" url="ldap://127.0.0.1/dc=eltaieb,dc=com" manager-dn="uid=admin,ou=system"  manager-password="secret"/>
 

 

</beans>
  